<style>
    /* 将 app-container 修改为 mainui-container */
    .mainui-container {
        display: flex;
        height: 100vh;
        width: 100vw;
        overflow: hidden;
        font-family: 'Segoe UI', sans-serif;
    }

    .sidebar {
        width: 350px;
        background-color: #252526;
        padding: 20px;
        display: flex;
        flex-direction: column;
        border-right: 1px solid #3e3e42;
    }

    .main-content {
        flex: 1;
        background-color: #1e1e1e;
        padding: 20px;
        display: flex;
        flex-direction: column;
    }

    h2 {
        margin-top: 0;
        font-size: 18px;
        color: #d4d4d4;
        margin-bottom: 15px;
    }

    .form-group {
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
    }

    label {
        font-size: 13px;
        color: #9cdcfe;
        margin-bottom: 5px;
    }

    textarea {
        background-color: #3c3c3c;
        color: #d4d4d4;
        border: 1px solid #555;
        border-radius: 4px;
        padding: 10px;
        font-family: inherit;
        resize: vertical;
    }

    textarea:focus {
        outline: 1px solid #007acc;
        border-color: #007acc;
    }

    .btn-primary {
        background-color: #0e639c;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 12px;
        font-weight: bold;
        cursor: pointer;
        margin-top: auto;
        transition: background 0.2s;
    }

    .btn-primary:hover {
        background-color: #1177bb;
    }

    .output-box {
        flex: 1;
        background-color: #2d2d30;
        border: 1px solid #3e3e42;
        border-radius: 4px;
        padding: 20px;
        color: #cecece;
        font-size: 15px;
        line-height: 1.6;
        overflow-y: auto;
        white-space: pre-wrap;
    }

    .placeholder {
        color: #808080;
        font-style: italic;
    }
</style>

<div class="mainui-container">
    <div class="sidebar">
        <h2>🛠️ 设定控制台</h2>

        <div class="form-group">
            <label>世界观与背景设定 (System Prompt)</label>
            <textarea @bind="WorldSetting" @bind:event="oninput" rows="6"
                      placeholder="例如：一个充满赛博朋克风格的魔法世界..."></textarea>
        </div>

        <div class="form-group">
            <label>本章剧情提示 (User Prompt)</label>
            <textarea @bind="ChapterPrompt" @bind:event="oninput" rows="4"
                      placeholder="例如：主角在酒馆遇到了一个神秘的机械师..."></textarea>
        </div>

        <button class="btn-primary" @onclick="StartGeneration">开始织梦 (Generate)</button>
    </div>

    <div class="main-content">
        <h2>📜 正文画布</h2>
        <div class="output-box">
            @if (string.IsNullOrWhiteSpace(GeneratedText))
            {
                <span class="placeholder">AI 编织的小说内容将在这里流式显示...</span>
            }
            else
            {
                @GeneratedText
            }
        </div>
    </div>
</div>

@code {
    private string WorldSetting { get; set; } = "";
    private string ChapterPrompt { get; set; } = "";
    private string GeneratedText { get; set; } = "";

    private void StartGeneration()
    {
        if (string.IsNullOrWhiteSpace(WorldSetting) || string.IsNullOrWhiteSpace(ChapterPrompt))
        {
            GeneratedText = "⚠️ 系统提示：请先在左侧输入世界观和剧情提示。";
            return;
        }

        GeneratedText = $"【系统连接就绪】\n加载世界观：{WorldSetting}\n加载剧情：{ChapterPrompt}\n\n正在呼叫大模型 API...\n(这里后续将替换为真实的流式打字机效果)";
    }

}